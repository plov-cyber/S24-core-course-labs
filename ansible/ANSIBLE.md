# Answers to Lab 5

## Deployment Output

```bash
ansible-playbook playbooks/dev/main.yml --diff


PLAY [Docker Playbook] **********************************************************************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] **********************************************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

TASK [docker : Install `pip`] ***************************************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

TASK [docker : Install required system packages] ********************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

TASK [docker : Add Docker's GPG key] ********************************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

TASK [docker : Add Docker Repository] *******************************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

TASK [docker : Install Docker] **************************************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

TASK [docker : Install Docker Compose] ******************************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

PLAY RECAP **********************************************************************************************************************************************************************************************************************************************************************************************************
aquamarine_iridium         : ok=7    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
```

## Inventory Details

```bash
ansible-inventory --list

{
    "_meta": {
        "hostvars": {
            "aquamarine_iridium": {
                "ansible_host": "79.174.83.76",
                "ansible_user": "root"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "regru"
        ]
    },
    "regru": {
        "hosts": [
            "aquamarine_iridium"
        ]
    }
}
```

# Answers to Lab 6

## Deployment Output

```bash
ansible-playbook playbooks/dev/main.yml --diff

PLAY [Deploy Python App Docker Image] *******************************************************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] **********************************************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

TASK [docker : Install `pip`] ***************************************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

TASK [docker : Install required system packages] ********************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

TASK [docker : Add Docker's GPG key] ********************************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

TASK [docker : Add Docker Repository] *******************************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

TASK [docker : Install Docker] **************************************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

TASK [docker : Install Docker Compose] ******************************************************************************************************************************************************************************************************************************************************************************
ok: [aquamarine_iridium]

TASK [web_app : Create directory for compose] ***********************************************************************************************************************************************************************************************************************************************************************
--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/root/devops-flask-app",
-    "state": "absent"
+    "state": "directory"
 }

changed: [aquamarine_iridium]

TASK [web_app : Stop old containers] ********************************************************************************************************************************************************************************************************************************************************************************
fatal: [aquamarine_iridium]: FAILED! => {"changed": false, "msg": "\"/root/devops-flask-app\" does not contain compose.yaml, compose.yml, docker-compose.yaml, or docker-compose.yml"}
...ignoring

TASK [web_app : Render docker-compose.yml] **************************************************************************************************************************************************************************************************************************************************************************
--- before
+++ after: /Users/levrekhlov/.ansible/tmp/ansible-local-873821mgsgjnq/tmpm1yvld34/docker-compose.yml.j2
@@ -0,0 +1,4 @@
+services:
+  web_app:
+    image: rekhlov/devops-flask-app:latest
+    ports: ['8080:8080']
\ No newline at end of file

changed: [aquamarine_iridium]

TASK [web_app : Compose] ********************************************************************************************************************************************************************************************************************************************************************************************
changed: [aquamarine_iridium]

TASK [web_app : Wipe image] *****************************************************************************************************************************************************************************************************************************************************************************************
skipping: [aquamarine_iridium]

TASK [web_app : Remove compose file] ********************************************************************************************************************************************************************************************************************************************************************************
skipping: [aquamarine_iridium]

PLAY RECAP **********************************************************************************************************************************************************************************************************************************************************************************************************
aquamarine_iridium         : ok=11   changed=3    unreachable=0    failed=0    skipped=2    rescued=0    ignored=1
```